These general-purpose functions are taken from http://www.biomecardio.com/pageshtm/tools/toolsen.htm